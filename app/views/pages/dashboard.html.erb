<% unless @goal.nil? %>
  <div class="container-main" data-controller="toggle">

      <div class="confetti d-none" data-toggle-target="confetti">
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
        <div class="confetti-piece"></div>
      </div>

      <div class="container-top">
        <div class="goal-title">
          <h2><%= @goal.title %> <%= @goal.emoji %></h2>
        </div>
      </div>

      <%# Pomodoro Timer %>
      <div data-controller="pomodoro" class="pomodoro-timer-sm">
        <div data-pomodoro-target="display">25:00</div>
      </div>

      <div class="container-center">
        <div class="progress-message">
          <% if @quote %>
            <div class="quote">
              <p><%= @quote["q"] %></p>
              <p><strong>- <%= @quote["a"] %></strong></p>
            </div>
          <% else %>
            <p>No quote found.</p>
          <% end %>
        </div>

        <div class="scroll-container">
            <% @tasks.each do |task| %>
              <div data-toggle-target="task" data-pagination-target="taskItem" data-task-id="<%= task.id %>">
                <%= task.title %>
                <form
                action="/goals/<%= @goal.id %>/tasks/<%= task.id %>"
                method="post" class="update-task-form">
                  <input type="hidden" name="_method" value="patch">
                  <input type="hidden" name="task[done]" value="check">
                    <% if task.done %>
                      <input data-toggle-target="input" checked data-action="input->toggle#submitForm" type="checkbox" class="btn btn-success btn-square-green inputSuccess">
                    <% else %>
                      <input data-toggle-target="input" data-action="input->toggle#submitForm" type="checkbox" class="btn btn-secondary btn-square-grey inputUndone">
                    <% end %>
                </form>


              </div>
            <% end %>
        </div>

    <div class="container">
      <%= image_tag(image_progress(@goal.progress)) %>
    </div>

  <% unless @goal.end_time.nil? %>
    <div class="days-remaining">
    <p><%= date_messages(@goal.remaining_days)%></p>
    </div>
  <% else %>
  <% end %>

        <div class="container">
          <%= image_tag(@goal.image_progress) %>
        </div>

        <% unless @goal.end_time.nil? %>
          <div class="days-remaining">
            <p><%= (@goal.end_time - DateTime.now).to_i / (60 * 60 * 24)%> days</p>
          </div>
        <% else %>
        <% end %>
      </div>


    <div class="container-bottom">
      <%= render "shared/navbar_bottom" %>
    </div>
</div>

    <% else %>
      <%= link_to new_goal_path do %>
        <div>
          <h1>Create your first goal!</h1>
        </div>
      <% end %>
    <% end %>
  </div>
